<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="UTF-8" />
    <title>Proactive Air Service - Gallery</title>

    <style>
      /* ===== BASE ===== */
      body {
        margin: 0;
        padding: 40px 20px;
        background: #f4f4f4;
        font-family: Arial, sans-serif;
        color: #222;
      }

      h1 {
        text-align: center;
        margin-bottom: 30px;
      }

      /* ===== GALLERY GRID ===== */
      .gallery-grid {
        max-width: 1200px;
        margin: 0 auto;
        display: grid;
        grid-template-columns: repeat(auto-fill, minmax(260px, 1fr));
        gap: 30px;
      }

      /* ===== GALLERY CARD ===== */
      .gallery-item {
        background: #ffffff;
        border-radius: 16px;
        overflow: hidden;
        box-shadow: 0 6px 14px rgba(0, 0, 0, 0.08);
        transition: 0.3s;
        position: relative;
      }

      .gallery-item:hover {
        transform: translateY(-6px) scale(1.03);
        box-shadow: 0 0 0 2px rgba(255, 215, 0, 0.6),
          0 16px 36px rgba(255, 215, 0, 0.35);
      }

      /* ===== IMAGE ===== */
      .gallery-item img {
        width: 100%;
        height: 200px;
        object-fit: cover;
        cursor: pointer;
      }

      /* ===== CAPTION ===== */
      .gallery-caption {
        padding: 14px;
        font-size: 0.9rem;
        color: #444;
      }

      .gallery-caption strong {
        display: block;
        margin-bottom: 6px;
      }

      .likes-comments {
        margin-top: 6px;
        font-size: 0.85rem;
        color: #777;
      }

      .comments-list {
        margin-top: 8px;
        font-size: 0.85rem;
        color: #555;
      }

      /* ===== DOWNLOAD BUTTON ===== */
      .download-btn {
        display: block;
        margin: 12px auto 16px auto;
        padding: 8px 16px;
        background: #1e1e1e;
        color: #fff;
        text-decoration: none;
        border-radius: 8px;
        font-size: 0.85rem;
        text-align: center;
        width: fit-content;
        transition: 0.25s;
      }

      .download-btn:hover {
        background: #000;
        box-shadow: 0 0 12px rgba(255, 215, 0, 0.9);
      }

      /* ===== PREVIEW OVERLAY ===== */
      .preview {
        display: none;
        position: fixed;
        inset: 0;
        background: rgba(0, 0, 0, 0.88);
        justify-content: center;
        align-items: center;
        z-index: 999;
      }

      .preview img {
        max-width: 90%;
        max-height: 90%;
        border-radius: 10px;
        box-shadow: 0 0 40px rgba(255, 215, 0, 0.4);
      }
    </style>
  </head>

  <body>
    <h1>Gallery</h1>

    <div class="gallery-grid" id="gallery">
      <p>Loading gallery...</p>
    </div>

    <!-- ðŸ” IMAGE PREVIEW -->
    <div class="preview" id="preview" onclick="this.style.display='none'">
      <img id="preview-img" />
    </div>

    <script>
      async function loadGallery() {
        const gallery = document.getElementById("gallery");
        const apiUrl = "http://127.0.0.1:8000/gallery/api/images/";

        try {
          const response = await fetch(apiUrl);
          if (!response.ok) {
            gallery.innerHTML = "<p>Error loading gallery</p>";
            return;
          }

          const photos = await response.json();
          gallery.innerHTML = "";

          if (photos.length === 0) {
            gallery.innerHTML = "<p>No photos available</p>";
            return;
          }

          photos.forEach((photo) => {
            const item = document.createElement("div");
            item.className = "gallery-item";

            const commentsHtml = photo.comments
              .map((c) => `<div><strong>${c.user}:</strong> ${c.comment}</div>`)
              .join("");

            item.innerHTML = `
              <img src="${photo.image_url}" alt="${
              photo.description || "Photo"
            }" />
              <div class="gallery-caption">
                <strong>Description:</strong>
                ${photo.description || "No description"}
                <div class="likes-comments">
                  Likes: ${photo.likes_count} | Comments: ${
              photo.comments.length
            }
                </div>
                <div class="comments-list">${commentsHtml}</div>
              </div>
              <a href="${
                photo.image_url
              }" download class="download-btn">Download</a>
            `;

            item.querySelector("img").onclick = () => {
              document.getElementById("preview-img").src = photo.image_url;
              document.getElementById("preview").style.display = "flex";
            };

            gallery.appendChild(item);
          });
        } catch (err) {
          console.error(err);
          gallery.innerHTML = "<p>Error loading gallery</p>";
        }
      }

      loadGallery();
    </script>
  </body>
</html>
